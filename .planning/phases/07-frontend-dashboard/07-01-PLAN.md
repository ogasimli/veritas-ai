---
phase: 07-frontend-dashboard
plan: 01
type: execute
---

<objective>
Set up dashboard foundation with dark mode, layout shell, and audit list functionality.

Purpose: Establish the core UI structure and theme system that all features depend on, enabling users to create and browse audits.
Output: Working dashboard layout with dark mode toggle, sidebar navigation, and functional audit list.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-frontend-dashboard/07-CONTEXT.md
@.planning/phases/07-frontend-dashboard/07-RESEARCH.md
@.planning/phases/01-foundation/01-02-SUMMARY.md
@frontend/app/layout.tsx
@frontend/app/page.tsx
@frontend/lib/api-client.ts

**Tech stack available:**
- Next.js 16.1.1 (App Router)
- React 19.2.3
- Shadcn UI (with button, card, table, badge components)
- TanStack Query 5.90.16
- Tailwind CSS 4
- TypeScript

**Established patterns:**
- Server Components for layout/static content
- Client Components ('use client') for interactivity
- API client in `frontend/lib/api-client.ts`
- Shadcn UI components in `frontend/components/ui/`

**User vision from CONTEXT.md:**
- Single-page dashboard with sidebar
- Flat audit list (no "Current Session" / "History" subsections)
- Dark mode toggle (floating button bottom right)
- Static user placeholder (no auth)
- Professional, calm aesthetic

**From RESEARCH.md:**
- Use next-themes for dark mode (prevents hydration flash)
- ThemeProvider wraps app with suppressHydrationWarning
- Dark mode attribute="class", defaultTheme="system"
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install and configure dark mode with next-themes</name>
  <files>frontend/package.json, frontend/components/providers/theme-provider.tsx, frontend/app/layout.tsx, frontend/components/layout/theme-toggle.tsx</files>
  <action>
Install next-themes: `npm install next-themes --prefix frontend`.

Create ThemeProvider client component at `frontend/components/providers/theme-provider.tsx`:
- Mark with 'use client'
- Import ThemeProvider from next-themes
- Export wrapper component that passes through props
- Include attribute, defaultTheme, enableSystem props

Update `frontend/app/layout.tsx`:
- Import ThemeProvider from @/components/providers/theme-provider
- Wrap {children} with ThemeProvider
- Add suppressHydrationWarning to html tag
- Configure: attribute="class", defaultTheme="system", enableSystem

Create theme toggle at `frontend/components/layout/theme-toggle.tsx`:
- Mark with 'use client'
- Use useTheme hook from next-themes
- Render floating button (fixed bottom-6 right-6, z-50)
- Toggle between 'light' and 'dark' onClick
- Use Material Icons (sun/moon) or lucide-react icons
- Style: bg-white dark:bg-slate-800, border, shadow-lg, rounded-full p-3

Use next-themes (not custom localStorage implementation) to avoid hydration mismatches and handle system preference automatically.
  </action>
  <verify>npm run build --prefix frontend succeeds. Dark mode toggle appears bottom-right. Clicking toggle switches between light/dark themes without flash.</verify>
  <done>next-themes installed and configured. ThemeProvider wraps app. Theme toggle button works. No hydration warnings in console. Build passes.</done>
</task>

<task type="auto">
  <name>Task 2: Create dashboard layout shell with sidebar</name>
  <files>frontend/app/(dashboard)/layout.tsx, frontend/components/layout/sidebar.tsx, frontend/app/(dashboard)/page.tsx, frontend/lib/api.ts</files>
  <action>
Create route group `frontend/app/(dashboard)/` for dashboard pages.

Create layout at `frontend/app/(dashboard)/layout.tsx` (Server Component):
- Import Sidebar from @/components/layout/sidebar
- Import ThemeToggle from @/components/layout/theme-toggle
- Structure: flex h-screen with sidebar (w-80, flex-shrink-0) + main content (flex-1)
- Place ThemeToggle after children (renders at bottom-right via fixed positioning)

Create Sidebar at `frontend/components/layout/sidebar.tsx` (Server Component):
- Logo area at top: Use /Users/orkhan/Desktop/logos/favicon.png as icon, "Veritas AI" title, "INTEGRITY AT SCALE" subtitle
- "New Audit" button below logo (use Link to /audit/new, style per mockup with primary-light bg)
- Audit list section (flat list, no subsections)
- Static user placeholder at bottom: hardcoded "JD" avatar, "Jane Doe", "Senior Auditor"
- Style per CONTEXT.md mockup: bg-surface-light dark:bg-surface-dark, border-r

Create home page at `frontend/app/(dashboard)/page.tsx` (Server Component):
- Empty state UI per mockup
- Large centered "Ready to start your first audit?" heading
- SVG shield illustration (optional - can use simple icon)
- "Create Report" button that links to /audit/new
- No "Import Data" button (out of scope per CONTEXT.md)
- Style: centered layout, calm professional aesthetic

Create API client at `frontend/lib/api.ts`:
- Export async function fetchAudits() that fetches from /api/audits
- Return mock data for now: [{id: '1', name: 'Audit #001', status: 'complete', createdAt: new Date().toISOString()}]
- Use native fetch (not external library)
- Type: Audit = {id: string, name: string, status: string, createdAt: string}

Do NOT create subsection headers like "Current Session" / "History" in sidebar (per CONTEXT.md simplifications). Do NOT add Settings/Logout buttons (no auth, per CONTEXT.md).
  </action>
  <verify>npm run dev --prefix frontend starts server. Visit http://localhost:3000 shows dashboard layout with sidebar on left, empty state in center, theme toggle bottom-right. Dark mode works. No console errors.</verify>
  <done>Dashboard layout renders with sidebar, logo, New Audit button, empty state home page. Theme toggle works. No TypeScript errors. Build succeeds.</done>
</task>

<task type="auto">
  <name>Task 3: Implement audit list in sidebar with TanStack Query</name>
  <files>frontend/components/layout/audit-list.tsx, frontend/components/layout/sidebar.tsx, frontend/app/(dashboard)/page.tsx</files>
  <action>
Create AuditList component at `frontend/components/layout/audit-list.tsx` (Client Component):
- Mark with 'use client'
- Use useQuery from @tanstack/react-query to fetch audits
- Query key: ['audits']
- Query function: calls fetchAudits from @/lib/api
- Render flat list of audit items
- Each item: Link to /audit/[id], show audit name, highlight if current
- Loading state: Show skeleton/spinner
- Empty state: Show "No audits yet" message
- Style per mockup: hover effects, active state highlighting

Update Sidebar to include AuditList:
- Import and render <AuditList /> below "New Audit" button
- No section headers (flat list per CONTEXT.md)

Update home page server component to use TanStack Query:
- Since Server Components can't use hooks, keep as simple server component
- Move any query logic to client component if needed
- Or pre-fetch data in Server Component and pass to client component

Use TanStack Query (already installed) for audit list state management, NOT useState or custom hooks. Leverage query caching and automatic refetch.
  </action>
  <verify>Visit http://localhost:3000. Sidebar shows "New Audit" button and audit list below it. Mock audit appears in list. Clicking audit navigates (404 expected - route not created yet). No console errors.</verify>
  <done>AuditList component fetches and displays audits using TanStack Query. Sidebar shows flat list of audits. Loading states work. Build passes.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build --prefix frontend` succeeds without errors
- [ ] Dark mode toggle appears bottom-right and switches themes smoothly
- [ ] No hydration warnings in browser console
- [ ] Dashboard layout renders with sidebar on left, content area on right
- [ ] Sidebar shows logo, "New Audit" button, audit list, user placeholder
- [ ] No "Current Session" / "History" headers in sidebar
- [ ] No Settings/Logout buttons
- [ ] Home page shows empty state with "Create Report" button
- [ ] Audit list fetches and displays (mock data for now)
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript or build errors
- Dark mode works without hydration flash
- Dashboard layout matches user vision from CONTEXT.md
- Ready for file upload implementation (07-02)
</success_criteria>

<output>
After completion, create `.planning/phases/07-frontend-dashboard/07-01-SUMMARY.md`:

# Phase 7 Plan 1: Dashboard Foundation Summary

**Dashboard layout with dark mode, sidebar navigation, and audit list established.**

## Accomplishments

- Installed and configured next-themes for dark mode
- Created dashboard layout shell with sidebar
- Implemented audit list with TanStack Query
- Added theme toggle (bottom-right floating button)
- Static user placeholder in sidebar

## Files Created/Modified

- `frontend/components/providers/theme-provider.tsx` - Theme provider wrapper
- `frontend/app/(dashboard)/layout.tsx` - Dashboard layout structure
- `frontend/components/layout/sidebar.tsx` - Sidebar with logo, nav, user
- `frontend/components/layout/theme-toggle.tsx` - Dark mode toggle button
- `frontend/components/layout/audit-list.tsx` - Audit list with TanStack Query
- `frontend/app/(dashboard)/page.tsx` - Empty state home page
- `frontend/lib/api.ts` - API client functions

## Decisions Made

- Used next-themes with suppressHydrationWarning to prevent flash
- Removed Settings/Logout buttons (no auth per CONTEXT.md)
- Removed "Current Session"/"History" subsections (simplified per CONTEXT.md)
- Used Server Components for layout, Client Components for interactivity

## Issues Encountered

None

## Next Step

Ready for 07-02-PLAN.md: File upload with validation
</output>
